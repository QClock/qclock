{"version":3,"sources":["webpack:///./src/components/Dimmer/index.js","webpack:///./src/pages/nightmode.js","webpack:///./src/state/remote.js","webpack:///./src/state/index.js","webpack:///./node_modules/isomorphic-ws/browser.js","webpack:///./src/components/Dimmer/dimmer.module.scss"],"names":["Dimmer","props","foo","deg","console","log","className","css","dimmer","dials","Dial","value","onChange","v","clsx","wheel","minute","min","max","dot","hour","arc_clip","arc","defaultProps","time","Date","NightMode","useAppState","state","connected","title","collectTimer","throttle","collectDelay","remoteAddress","window","url","this","getWsURL","socket","WebSocket","addEventListener","e","onUpdate","JSON","parse","data","addListener","func","send","readyState","stringify","upload","clearTimeout","setTimeout","location","host","context","useContext","Context","remote","remoteState","newState","Object","assign","color","datetime","dim","setState","action","type","arm","colorReducer","timeReducer","ws","MozWebSocket","global","self","module","exports"],"mappings":"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","file":"component---src-pages-nightmode-js-7b1f317ed481eef4b65a.js","sourcesContent":["import React, { useState } from \"react\"\nimport PropTypes from 'prop-types'\nimport clsx from 'clsx';\n\nimport Dial from '../Dial'\n\nimport css from './dimmer.module.scss';\n\nconst Dimmer = (props) => {\n\n  const foo = (deg) => {\n    console.log(deg)\n  }\n\n  return (<div className={ css.dimmer }>\n    <div className={ css.dials }>\n      <Dial\n        value={ 0 }\n        onChange={ v => foo(v) }\n        className={ clsx(css.wheel, css.minute) }\n        min={ 30 }\n        max={ 150 }\n      >\n        <div className={ css.dot }></div>\n      </Dial>\n      <Dial\n        value={ 0 }\n        onChange={ v => foo(v) }\n        className={ clsx(css.wheel, css.hour) }\n        min={ 30 }\n        max={ 150 }\n      >\n        <div className={ css.dot }></div>\n      </Dial>\n    </div>\n    <div className={ css.arc_clip }>\n      <div className={ css.arc }></div>\n    </div>\n  </div>)\n}\n\nDimmer.propTypes = {\n  onChange: PropTypes.func.isRequired,\n  time: PropTypes.object,\n  className: PropTypes.string,\n}\n\nDimmer.defaultProps = {\n  time: new Date(),\n  className: '',\n}\n\nexport default Dimmer\n","import React from 'react'\nimport useAppState from '../state'\nimport Layout from '../components/layout'\nimport SEO from '../components/seo'\nimport Dimmer from '../components/Dimmer'\n\nconst NightMode = () => {\n  const [ state, dispatch ] = useAppState();\n  return (\n    <Layout connected={ state.connected }>\n      <SEO title=\"QCLK\" />\n\n      <Dimmer\n        time={ new Date() }\n        onChange={ (v) => {\n          //console.log(v)\n        }}\n      />\n\n    </Layout>\n  )\n}\n\nexport default NightMode\n","import WebSocket  from 'isomorphic-ws'\n\nexport default new class {\n\n  collectTimer = 0\n  throttle = true\n  collectDelay = 5\n  remoteAddress = '192.168.0.4:8080'\n\n  constructor () {\n    if (typeof window == 'undefined') {\n      this.socket = null\n      return\n    }\n\n    const url = this.getWsURL()\n    this.socket = new WebSocket(url);\n\n    this.socket.addEventListener('message', (e) => {\n      if (this.onUpdate) {\n        this.onUpdate(JSON.parse(e.data))\n      }\n    })\n  }\n\n  addListener (func) {\n    this.onUpdate = func\n  }\n\n  send(state) {\n    if (this.socket.readyState === 1) {\n      this.socket.send(JSON.stringify(state))\n    }\n  }\n\n  upload (state) {\n    if (!this.throttle) {\n      this.send(state)\n      return\n    }\n\n    clearTimeout(this.collectTimer)\n\n    this.collectTimer = setTimeout(() => {\n      this.send(state)\n    }, this.collectDelay)\n  }\n\n  getWsURL () {\n    const {\n      host\n    } = window.location\n\n    return `ws://${host}`\n  }\n}()\n","\nimport { useContext } from 'react';\nimport Context from './context'\nimport remote from './remote'\n\nconst colorReducer = (state, action) => {\n  const color = Object.assign({}, state.color, {\n    [action.arm]: action.value\n  })\n  return Object.assign(\n    {},\n    state,\n    {\n      color\n    })\n}\n\nconst timeReducer = (state, action) => {\n  return Object.assign(\n    {},\n    state,\n    {\n      time: action.value\n    }\n  );\n}\n\nexport default () => {\n  const context = useContext(Context)\n\n  remote.addListener((remoteState) => {\n    const newState = Object.assign({}, context.state,\n      {\n        connected: true\n      },\n      {\n        color: remoteState.color\n      },\n      {\n        time: new Date(remoteState.datetime)\n      },\n      {\n        dim: remoteState.dim\n      }\n    )\n    context.setState(newState)\n  })\n\n  const dispatch = (action) => {\n    let newState;\n    switch(action.type) {\n      case 'color':\n        newState = colorReducer(context.state, action)\n        break;\n      case 'time':\n        newState = timeReducer(context.state, action)\n        break;\n      default:\n        newState = context.state;\n    }\n    context.setState(newState)\n    remote.upload(newState)\n  }\n\n  return [ context.state, dispatch ]\n}\n","// https://github.com/maxogden/websocket-stream/blob/48dc3ddf943e5ada668c31ccd94e9186f02fafbd/ws-fallback.js\nvar ws = null;\n\nif (typeof WebSocket !== 'undefined') {\n  ws = WebSocket;\n} else if (typeof MozWebSocket !== 'undefined') {\n  ws = MozWebSocket;\n} else if (typeof global !== 'undefined') {\n  ws = global.WebSocket || global.MozWebSocket;\n} else if (typeof window !== 'undefined') {\n  ws = window.WebSocket || window.MozWebSocket;\n} else if (typeof self !== 'undefined') {\n  ws = self.WebSocket || self.MozWebSocket;\n}\n\nmodule.exports = ws;","// extracted by mini-css-extract-plugin\nmodule.exports = {\"dimmer\":\"dimmer-module--dimmer--3Uixq\",\"dials\":\"dimmer-module--dials--1waR9\",\"wheel\":\"dimmer-module--wheel--3MUf5\",\"dot\":\"dimmer-module--dot--ggFSW\",\"minute\":\"dimmer-module--minute--2N6b4\",\"hour\":\"dimmer-module--hour--Pmcma\",\"arc_clip\":\"dimmer-module--arc_clip--1_htg\",\"arc\":\"dimmer-module--arc--25CY9\",\"timeinput\":\"dimmer-module--timeinput--2Z0nl\"};"],"sourceRoot":""}